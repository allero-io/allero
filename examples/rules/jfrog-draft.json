{
    "description": "Ensure that at least one pipeline in each repository runs Terraform scanner",
    "failureMessage": "Terraform scanner was not detected in the repository pipelines. It is highly recommended to add one to ensure that infrastructure is well configured.",
    "uniqueId": 13,
    "enabledByDefault": true,
    "inCodeImplementation": false,
    "schema": {
        "definitions": {
            "passwordPattern": {
                "type": "string",
                "pattern": "\\${{.*}}( *|$)|DYNAMIC_VALUE"
            },
            "lookup": {
                "properties": {
                    "configuration": {
                        "type": "object",
                        "patternProperties": {
                            ".*password.*": {
                                "$ref": "#/definitions/passwordPattern"
                            },
                            "inputResources": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "patternProperties": {
                                        ".*password.*": {
                                            "$ref": "#/definitions/passwordPattern"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "allOf": [
            {
                "$ref": "#/definitions/lookup"
            }
        ],
        "additionalProperties": {
            "$ref": "#"
        },
        "items": {
            "$ref": "#"
        }
    }
}